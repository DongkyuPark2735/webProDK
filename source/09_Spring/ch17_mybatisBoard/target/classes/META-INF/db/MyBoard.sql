

SELECT E.MGR, MG.ENAME FROM EMP E, EMP MG WHERE E.MGR = MG.EMPNO;

-- DEPT.XML ID=DEPLIST
SELECT * FROM DEPT;

-- EMP.XML ID=EMPLIST
-- SELECT * FROM EMP ORDER BY EMPNO; -- 출력조건
SELECT * FROM 
    (SELECT ROWNUM RN, A.* FROM
        (SELECT * FROM EMP ORDER BY EMPNO) A)
            WHERE RN BETWEEN 6 AND 10;

-- Emp.xml id = empDeptList
-- SELECT E.*, DNAME, LOC FROM EMP E, DEPT D WHERE E.DEPTNO=D.DEPTNO ORDER BY EMPNO;
SELECT * FROM (SELECT ROWNUM RN, A.* FROM 
    (SELECT E.*, DNAME, LOC FROM EMP E, DEPT D WHERE E.DEPTNO=D.DEPTNO ORDER BY EMPNO) A)
        WHERE RN BETWEEN 6 AND 10;

-- EMP.XML ID=TOTCNT           
SELECT COUNT(*) FROM EMP;

-- EMP.XML ID=DETAIL
SELECT * FROM EMP WHERE EMPNO = 7698;

-- EMP.XML ID=MANAGERLIST
SELECT * FROM EMP WHERE EMPNO IN (SELECT MGR FROM EMP);

-- EMP.XML ID=INSERT
DESC EMP;
INSERT INTO EMP VALUES (9001, '홍길동', 'IT', 7902, '22/07/20', 6000, 800, 40);

-- EMP.XML ID=UPDATE
UPDATE EMP SET ENAME = '홍홍홍',
                      JOB='MANAGER',
                      MGR = 7839,
                     HIREDATE = '21/07/20',
                     SAL = 7000,
                     COMM = 500
                     WHERE EMPNO = 9000;
                     
-- EMP.XML ID=DELETE
DELETE FROM EMP WHERE EMPNO = 9000;

commit;                     
                     
                     

DROP TABLE MVC_BOARD CASCADE CONSTRAINTS;
DROP SEQUENCE MVC_BOARD_SEQ;
CREATE SEQUENCE MVC_BOARD_SEQ MAXVALUE 999999 NOCACHE NOCYCLE;
CREATE TABLE MVC_BOARD(
    bID NUMBER(6),
    bNAME VARCHAR2(50) NOT NULL,
    bTITLE VARCHAR2(100) NOT NULL,
    bCONTENT VARCHAR2(1000),
    bDATE DATE DEFAULT SYSDATE NOT NULL,
    bHIT NUMBER(6) DEFAULT 0 NOT NULL,
    bGROUP NUMBER(6) NOT NULL,
    bSTEP NUMBER(3) NOT NULL,
    bINDENT NUMBER(3) NOT NULL,
    bIP VARCHAR2(20) NOT NULL,
    PRIMARY KEY(bID)
);
INSERT INTO MVC_BOARD (bID, bNAME, bTITLE, bCONTENT, bGROUP, bSTEP, bINDENT, bIP)
    VALUES (MVC_BOARD_SEQ.NEXTVAL, '홍길동','제목','본문',MVC_BOARD_SEQ.CURRVAL, 0, 0, '127.0.0.1');


-- DAO에 들어갈 쿼리
-- 글목록 (startRow ~ endRow까지)
SELECT * FROM MVC_BOARD ORDER BY BGROUP DESC, BSTEP;
SELECT * FROM (SELECT ROWNUM RN, A.* 
            FROM (SELECT * FROM MVC_BOARD ORDER BY BGROUP DESC, BSTEP) A)
        WHERE RN BETWEEN 1 AND 3;

-- 전체 글 갯수
SELECT COUNT(*) FROM MVC_BOARD;

-- 원글쓰기
INSERT INTO MVC_BOARD (bID, bNAME, bTITLE, bCONTENT, bGROUP, bSTEP, bINDENT, bIP)
    VALUES (MVC_BOARD_SEQ.NEXTVAL, '홍길동','제목2','본문2',MVC_BOARD_SEQ.CURRVAL, 0, 0, '127.0.0.1');

-- bID글 조회수 1회 올리기
UPDATE MVC_BOARD SET bHIT = bHIT+1 WHERE bID=2;

-- bID로 DTO가져오기(상세글 보기)
SELECT * FROM MVC_BOARD WHERE BID=2;

-- 답변글 쓰기전 step A
UPDATE MVC_BOARD SET BSTEP=BSTEP+1 WHERE BGROUP=2 AND BSTEP>0;

-- 답변글 쓰기(2번글의 답변)
INSERT INTO MVC_BOARD (bID, bNAME, bTITLE, bCONTENT, bGROUP, bSTEP, bINDENT, bIP)
    VALUES (MVC_BOARD_SEQ.NEXTVAL, '답변자','글2첫답','본문2답변',2,1,1,'127.0.0.1');

-- 글 수정하기
UPDATE MVC_BOARD SET BNAME='김김김',
                    BTITLE = '바뀐제목',
                    BCONTENT = '바뀐내용',
                    BIP = '192.168.20.44'
        WHERE BID=2;
-- 글삭제하기
DELETE FROM MVC_BOARD WHERE BID=1;
COMMIT;
SELECT to_char(bdate,'yyyy/mm/dd hh:mi') FROM MVC_BOARD ORDER BY BGROUP DESC, BSTEP;
            
            






